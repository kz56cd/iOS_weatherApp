name: CI

on:
  push:
    branches:
      - main
      - master
  pull_request:
    branches:
      - main
      - master

jobs:
  build-and-test:
    runs-on: macos-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Cache SPM dependencies
      # SPMのキャッシュパスはユーザーのホームディレクトリにあります
      uses: actions/cache@v4
      with:
        path: ~/Library/Caches/org.swift.swiftpm/
        key: ${{ runner.os }}-spm-${{ hashFiles('**/Package.resolved') }}
        restore-keys: |
          ${{ runner.os }}-spm-

    - name: Build and Test
      run: |
        # Xcodeプロジェクト名とスキーム名は、通常プロジェクト名と同じです。
        # シミュレーターは、GitHub ActionsのmacOSランナーで利用可能なものを選びます。
        # CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO は、CI環境でコード署名エラーを避けるために重要です。
        xcodebuild clean build test           -project WeatherApp.xcodeproj           -scheme WeatherApp           -destination 'platform=iOS Simulator,name=iPhone 15'           -only-testing WeatherAppTests           -enableCodeCoverage YES           CODE_SIGN_IDENTITY=""           CODE_SIGNING_REQUIRED=NO



